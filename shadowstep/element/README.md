# Shadowstep Element API

> A robust and fail-safe lazy abstraction over Appium WebElement.

## Overview

This module provides a powerful `Element` class designed to interact with Android UI elements in Appium.
It strictly follows the **lazy evaluation** principle — no actual element is fetched until interaction happens.

It supports:
- Lazy navigation (`get_parent`, `get_cousin`, `get_elements`)
- Greedy interactions (`click`, `tap`, `scroll`, etc.)
- Robust error handling with auto-reconnect
- Deep XPath and UiSelector support
- Full parity with `WebElement` API

> **Note**: Only XPath strategy is supported. Always pass locators as `Tuple[str, str]` or `Dict[str, str]`.

---

## Quickstart

```python
from shadowstep.element.element import Element

# Create a lazy element
ok_button = Element(locator={"text": "OK"})

# Tap it (invokes driver only now)
ok_button.tap()

# Scroll to a deeply nested cousin
wifi_toggle = ok_button.get_cousin(
    ancestor_locator={"resource-id": "android:id/list"},
    cousin_locator={"text": "Wi‑Fi"}
)
wifi_toggle.tap()

# Wait for it to disappear
ok_button.wait_for_not_visible(timeout=5)
```

---

## Method Categories

| Category      | Evaluation | Methods                                                                 |
|---------------|------------|-------------------------------------------------------------------------|
| **Interaction**   | GREEDY     | `tap`, `click`, `click_double`, `send_keys`, `clear`, `set_value`       |
| **Gestures**      | GREEDY     | `tap_and_move`, `swipe_*`, `scroll_*`, `fling_*`, `zoom`, `unzoom`      |
| **Navigation**    | LAZY       | `get_parent`, `get_parents`, `get_sibling(s)`, `get_cousin`, `from_parent` |
| **Getters**       | LAZY       | `get_element`, `get_elements`, `get_elements_greedy`                    |
| **Assertions**    | GREEDY     | `is_visible`, `is_selected`, `is_enabled`, `is_contains`                |
| **Waits**         | GREEDY     | `wait`, `wait_visible`, `wait_clickable`, `wait_for_not_*`              |
| **Properties**    | GREEDY     | `text`, `size`, `tag_name`, `accessible_name`, `aria_role`, etc.        |
| **Screenshots**   | GREEDY     | `screenshot_as_base64`, `screenshot_as_png`, `save_screenshot`          |

> **GREEDY** = immediately queries the element and returns value
>
> **LAZY** = only wraps XPath/locator and delays resolution until interaction

---

## Error Handling

All methods are equipped with:
- Retry logic
- Reconnection via `self.base.reconnect()`
- Safe fallbacks (GREEDY methods return `bool` instead of raising if possible)

---

## XPath & Locator Support

Supports:
- Deep XPath with `ancestor::*`, `following-sibling::*`, `contains`, `starts-with`
- Dict-style locators like `{"text": "Wi‑Fi"}`
- Chainable calls: `get_element().get_sibling().tap()`

---

## Not Implemented in UiAutomator2 (warnings only)

The following methods exist but emit warnings (not errors) if used:
- `get_property()`
- `shadow_root`
- `location_once_scrolled_into_view`
- `submit()`
- `value_of_css_property()`
- `location`
- 'and others (in development...)'

---

## License

MIT License

---

## Author

Designed and maintained by [Klim Molokov](https://github.com/molokov-klim) for Shadowstep framework.

---

## Contributing

Pull requests and improvements are welcome. Please submit tests for new functionality.

(c) almost generated by AI 